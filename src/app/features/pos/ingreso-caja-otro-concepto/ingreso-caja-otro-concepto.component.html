<div class="ingreso-caja-container">
  <div class="header">
    <div class="header-left">
      <h1>Ingreso a Caja por Otro Concepto</h1>
      <p class="subtitle">Registre un ingreso de dinero a la caja por un concepto diferente a pago de vehículo</p>
    </div>
    <div class="header-right">
      @if (companyName) {
      <div class="info-item">
        <i class="pi pi-building"></i>
        <span>{{ companyName }}</span>
      </div>
      }
      @if (currentShift) {
      <div class="info-item shift-info">
        <i class="pi pi-clock"></i>
        <span><strong>Turno:</strong> {{ getShiftDisplayText() }}</span>
      </div>
      }
      <div class="info-item time-info">
        <i class="pi pi-calendar-clock"></i>
        <span>{{ currentTime }}</span>
      </div>
      <div class="info-item pos-button">
        <p-button 
          label="Ver Operaciones" 
          icon="pi pi-home"
          (onClick)="goToDashboard()"
          styleClass="p-button-outlined p-button-secondary">
        </p-button>
      </div>
    </div>
  </div>

  <form [formGroup]="form" (ngSubmit)="submit()" class="form-container">
    <div class="form-group">
      <label for="amount">Monto *</label>
      <p-inputNumber 
        id="amount" 
        formControlName="amount"
        [min]="0.01"
        [max]="999999999"
        [minFractionDigits]="2"
        [maxFractionDigits]="2"
        mode="decimal"
        currency="COP"
        locale="es-CO"
        [class.ng-invalid]="form.get('amount')?.invalid && form.get('amount')?.touched"
        styleClass="w-full">
      </p-inputNumber>
      @if (form.get('amount')?.invalid && form.get('amount')?.touched) {
      <small class="p-error">
        @if (form.get('amount')?.errors?.['required']) {
        <span>El monto es requerido</span>
        }
        @if (form.get('amount')?.errors?.['min']) {
        <span>El monto debe ser mayor a 0</span>
        }
      </small>
      }
      @if (form.get('amount')?.valid) {
      <small class="p-text-secondary">
        Ingrese el monto del ingreso a registrar
      </small>
      }
    </div>

    <div class="form-group">
      <label for="notes">Notas (Opcional)</label>
      <textarea 
        id="notes" 
        pInputTextarea 
        formControlName="notes" 
        rows="4" 
        placeholder="Describa el concepto del ingreso (ej: venta de productos, servicio adicional, etc.)..."
        [class.ng-invalid]="form.get('notes')?.invalid && form.get('notes')?.touched">
      </textarea>
      <small class="p-text-secondary">
        Información adicional sobre el concepto del ingreso
      </small>
    </div>

    <div class="form-actions">
      <p-button 
        type="submit" 
        label="Registrar Ingreso" 
        icon="pi pi-check"
        [disabled]="form.invalid || loading || loadingShift || !currentShift">
      </p-button>
      <p-button 
        type="button" 
        label="Limpiar" 
        icon="pi pi-times" 
        (onClick)="form.reset()"
        [disabled]="loading || loadingShift" 
        styleClass="p-button-secondary">
      </p-button>
    </div>
  </form>


  <p-toast></p-toast>
</div>
