<div class="registrar-cliente-container">
  <div class="header">
    <h1>Registrar Cliente</h1>
    <p class="subtitle">Complete la información del cliente para registrarlo en el sistema</p>
  </div>

  <p-card class="form-card">
    <form [formGroup]="form" (ngSubmit)="submit()">
      <div class="form-group">
        <label for="fullName">Nombre Completo *</label>
        <input 
          id="fullName"
          type="text" 
          pInputText 
          formControlName="fullName"
          placeholder="Ej: Juan Pérez"
          [class.ng-invalid]="form.get('fullName')?.invalid && form.get('fullName')?.touched"
          maxlength="100">
        @if (form.get('fullName')?.invalid && form.get('fullName')?.touched) {
          <small class="p-error">
            @if (form.get('fullName')?.errors?.['required']) {
              <span>El nombre completo es requerido</span>
            }
            @if (form.get('fullName')?.errors?.['minlength']) {
              <span>El nombre debe tener al menos 3 caracteres</span>
            }
            @if (form.get('fullName')?.errors?.['maxlength']) {
              <span>El nombre no puede tener más de 100 caracteres</span>
            }
          </small>
        }
      </div>

      <div class="form-group">
        <label for="typeIdentity">Tipo de Identificación *</label>
        <div class="select-wrapper">
          <app-select-lib
            formControlName="typeIdentity"
            [options]="typeIdentityOptions"
            label=""
            [showClear]="false">
          </app-select-lib>
        </div>
        @if (form.get('typeIdentity')?.invalid && form.get('typeIdentity')?.touched) {
          <small class="p-error">
            @if (form.get('typeIdentity')?.errors?.['required']) {
              <span>El tipo de identificación es requerido</span>
            }
          </small>
        }
      </div>

      <div class="form-group">
        <label for="numberIdentity">Número de Identificación *</label>
        <input 
          id="numberIdentity"
          type="text" 
          pInputText 
          formControlName="numberIdentity"
          placeholder="Ej: 1234567890"
          [class.ng-invalid]="form.get('numberIdentity')?.invalid && form.get('numberIdentity')?.touched"
          maxlength="20">
        @if (form.get('numberIdentity')?.invalid && form.get('numberIdentity')?.touched) {
          <small class="p-error">
            @if (form.get('numberIdentity')?.errors?.['required']) {
              <span>El número de identificación es requerido</span>
            }
            @if (form.get('numberIdentity')?.errors?.['minlength']) {
              <span>El número debe tener al menos 5 caracteres</span>
            }
            @if (form.get('numberIdentity')?.errors?.['maxlength']) {
              <span>El número no puede tener más de 20 caracteres</span>
            }
          </small>
        }
      </div>

      <div class="form-group">
        <label for="people">Personas (Opcional)</label>
        <input 
          id="people"
          type="text" 
          pInputText 
          formControlName="people"
          placeholder="Ej: 2"
          maxlength="50">
        <small class="p-text-secondary">
          Información adicional sobre el cliente
        </small>
      </div>

      <div class="form-group">
        <label for="paymentDay">Día de Pago (Opcional)</label>
        <input 
          id="paymentDay"
          type="date" 
          pInputText 
          formControlName="paymentDay"
          [max]="getMaxDate()">
        <small class="p-text-secondary">
          Día del mes en que el cliente realiza el pago
        </small>
      </div>

      <div class="form-actions">
        <p-button 
          type="submit"
          label="Registrar Cliente"
          icon="pi pi-check"
          [disabled]="form.invalid || loading">
        </p-button>
        <p-button 
          type="button"
          label="Limpiar" 
          icon="pi pi-times"
          (onClick)="form.reset(); form.patchValue({ typeIdentity: 'CC' })"
          [disabled]="loading"
          styleClass="p-button-secondary">
        </p-button>
      </div>
    </form>
  </p-card>

  @if (error) {
    <p-message 
      severity="error" 
      [text]="error"
      [closable]="true"
      (onClose)="error = null"
      [style]="{'margin-top': '1rem'}">
    </p-message>
  }

  @if (success) {
    <p-message 
      severity="success" 
      [text]="success"
      [closable]="true"
      (onClose)="success = null"
      [style]="{'margin-top': '1rem'}">
    </p-message>
  }
</div>

